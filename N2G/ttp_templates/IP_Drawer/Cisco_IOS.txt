<doc>
Template produces this dictionary:
{'Cisco_IOS': {'arp': [{'age': '-',
                        'hostname': 'switch_1',
                        'interface': 'SVI123',
                        'ip': '10.123.111.1',
                        'mac': 'd094.6643.1111',
                        'type': 'ARPA'},
                       {'age': '0',
                        'hostname': 'switch_1',
                        'interface': 'SVI123',
                        'ip': '10.123.111.3',
                        'mac': '0008.e3ff.1333',
                        'type': 'ARPA'}],
               'networks': {'10.11.11.0/24': [{'interface': 'SVI11',
                                              'ip': '10.11.11.0',
                                              'netmask': '24',
                                              'hostname': 'switch_2'}],
                            '10.123.0.5/32': [{'interface': 'Lo0',
                                              'ip': '10.123.0.5',
                                              'netmask': '32',
                                              'hostname': 'switch_2'}],
                            '10.123.2.4/31': [{'interface': 'Te1/1/4',
                                               'ip': '10.123.2.4',
                                               'netmask': '31',
                                               'hostname': 'switch_1'},
                                              {'interface': 'Ge1/4',
                                               'ip': '10.123.2.4',
                                               'netmask': '31',
                                               'hostname': 'switch_2'}],
               'nodes': {'switch_1': {'interfaces': {'Lo0': {'port_description': 'Routing '
                                                                                 'Loopback'},
                                                     'Te1/1/3': {'port_description': 'to SWITCH_2 '
                                                                                     'vrf VRF1 '
                                                                                     'link 1',
                                                                 'vrf': 'VRF2'}}},
                         'switch_2': {'interfaces': {'Ge1/3': {'port_description': 'to SWITCH_1 '
                                                                                   'link 1',
                                                               'vrf': 'VRF1'}}}}}}
</doc>

<template name="Cisco_IOS" results="per_template">
<vars>local_hostname="gethostname"</vars>

<input>url = "./Cisco_IOS/"</input>

<!-- Interfaces configuration group -->
<group name="nodes.{{ local_hostname }}.interfaces.{{ interface }}" record="interface">
interface {{ interface | resuball("IfsNormalize") }}
 description {{ port_description | re(".+") }}
 vrf forwarding {{ vrf }}
 ip vrf forwarding {{ vrf }}
 ip access-group {{ ACL_IN }} in
 ip access-group {{ ACL_OUT }} out
 <group name="/networks**.{{ network }}*" chain="set('interface') | add_network()" method="table">
 ip address {{ ip | IP }} {{ netmask }}
 ip address {{ ip | IP }} {{ netmask }} secondary
 {{ hostname | set("local_hostname") }}
 </group>
</group>

<!-- ARP cache group -->
<group name="arp*" method="table">
Internet  {{ ip | IP }}     {{ age }}   {{ mac | MAC }}  {{ type }}   {{ interface | resuball("IfsNormalize") }}
{{ hostname | set("local_hostname") }}
</group>

</template>